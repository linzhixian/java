<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.funugame.parkour.dao.UserVaryMapper">
	<cache eviction="LRU" flushInterval="86400000" size="6144"  readOnly="true"/>

	<insert id="insert" parameterType="UserVary">
		INSERT INTO
		user_vary
		<set>
			uid=#{uid},
			<if test="exp != null">exp = #{exp},</if>
			<if test="age != null">age = #{age},</if>
			<if test="gold != null">gold = #{gold},</if>
			<if test="diamond != null">diamond = #{diamond},</if>
			<if test="strength != null">strength = #{strength},lastupdatestrengthtime=now(),</if>
		</set>

	</insert>

	<select id="selectVaryList" parameterType="int" resultType="UserVary">
		select uid,diamond,gold from user_vary
		<where>
			uid=#{uid}
		</where>
	</select>

	<select id="selectOne" parameterType="int" resultType="UserVary">
		select * from user_vary
		<where>
			uid=#{uid}
		</where>
	</select>

	<update id="update" parameterType="UserVary">
		UPDATE user_vary
		<set>
			<if test="exp != null">exp = #{exp},</if>
			<if test="age != null">age = #{age},</if>
			<if test="gold != null">gold = #{gold},</if>
			<if test="diamond != null">diamond = #{diamond},</if>
			<if test="strength != null">strength = #{strength},lastupdatestrengthtime=now(),</if>
			<if test="bone != null">bone = #{bone},</if>
			<if test="cup != null">cup = #{cup},</if>
			<if test="cuplevel != null">cuplevel = #{cuplevel},</if>
			<if test="techpoint != null">techpoint = #{techpoint},</if>
			<if test="totalrunnum != null">totalrunnum = #{totalrunnum}</if>
		</set>
		WHERE uid = #{uid}
	</update>
	
	<update id="submitRunResult" parameterType="hashmap">
		UPDATE user_vary
		<set>
			runcount=runcount+1,
			getgold=getgold+#{gold},
			bosscount=bosscount+#{bosscount},
			challengecount =challengecount+#{challengecount}
			<if test="totalrunnum != null">,totalrunnum = #{totalrunnum}</if>
			<!-- <if test="exp != null">exp =exp+#{exp},</if> <if test="age != null">age = #{age},</if> <if test="gold != null">gold = gold+#{gold},</if> -->
		</set>
		WHERE uid = #{uid}
	</update>

	<update id="plus" parameterType="UserVary">
		UPDATE user_vary
		<set>
			<if test="exp != null">exp =exp+#{exp},</if>
			<if test="age != null">age = #{age},</if>
			<if test="gold != null">gold = gold+#{gold},</if>
			<if test="strength != null">strength =strength+#{strength},</if>
		</set>
		WHERE uid = #{uid}
	</update>

	<update id="clearCupLevel">
		UPDATE user_vary set cuplevel=0 where cuplevel!=0;
	</update>

	<update id="updateCupLevel" parameterType="hashmap">
		UPDATE user_vary
		<set>
			cuplevel=#{cuplevel}
		</set>
		WHERE uid = #{uid}
	</update>

</mapper>