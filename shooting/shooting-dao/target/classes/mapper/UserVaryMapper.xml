<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.funugame.parkour.dao.UserVaryMapper">
	<cache eviction="LRU" flushInterval="86400000" size="2048" />

	<insert id="insert" parameterType="UserVary">
		INSERT INTO
		user_vary
		<set>
			uid=#{uid},
			<if test="exp != null">exp = #{exp},</if>
			<if test="age != null">age = #{age},</if>
			<if test="gold != null">gold = #{gold},</if>
			<if test="diamond != null">diamond = #{diamond},</if>
			<if test="strength != null">strength = #{strength},lastupdatestrengthtime=now(),</if>
		</set>

	</insert>

	<select id="selectDiamond" parameterType="int" resultType="UserVary">
		select uid,diamond,gold from user_vary
		<where>
			uid=#{uid}
		</where>
	</select>

	<select id="selectOne" parameterType="int" resultType="UserVary">
		select * from user_vary
		<where>
			uid=#{uid}
		</where>
	</select>

	<update id="updateDiamond" parameterType="UserVary">
		UPDATE user_vary
		<set>
			<if test="diamond != null">diamond = #{diamond},</if>
		</set>
		WHERE uid = #{uid}
	</update>
	<update id="updateGold" parameterType="UserVary">
		UPDATE user_vary
		<set>
			<if test="gold != null">gold = #{gold},</if>
		</set>
		WHERE uid = #{uid}
	</update>
	<update id="updateAge" parameterType="UserVary">
		UPDATE user_vary
		<set>
			<if test="age != null">age = #{age},</if>
		</set>
		WHERE uid = #{uid}
	</update>

	<update id="update" parameterType="UserVary">
		UPDATE user_vary
		<set>
			<if test="exp != null">exp = #{exp},</if>
			<if test="age != null">age = #{age},</if>
			<if test="gold != null">gold = #{gold},</if>
			<if test="diamond != null">diamond = #{diamond},</if>
			<if test="strength != null">strength = #{strength},lastupdatestrengthtime=now(),</if>
		</set>
		WHERE uid = #{uid}
	</update>
	<update id="submitRunResult" parameterType="UserVary">
		UPDATE user_vary
		<set>
			runcount=runcount+1,
			totalgetgold=totalgetgold+gold,
			<!-- <if test="exp != null">exp =exp+#{exp},</if>
			<if test="age != null">age = #{age},</if>
			<if test="gold != null">gold = gold+#{gold},</if>
			 -->
			strength=strength-1
		</set>
		WHERE uid = #{uid}
	</update>

	<update id="plus" parameterType="UserVary">
		UPDATE user_vary
		<set>
			<if test="exp != null">exp =exp+#{exp},</if>
			<if test="age != null">age = #{age},</if>
			<if test="gold != null">gold = gold+#{gold},</if>
			<if test="strength != null">strength =strength+#{strength},</if>
		</set>
		WHERE uid = #{uid}
	</update>

</mapper>